<!DOCTYPE html>
<html>
<head>
  <title>Question Form</title>
</head>
<body>

  <h1 id="test">Question Form</h1>
  <form id="questionForm">
    <p>Aucun formulaire en cours</p>
  </form>

  <script>
    if (!document.cookie.includes('token')) {
      window.location.href = '/login.html';
    }

    document.addEventListener('DOMContentLoaded', async function() {
      const formElem = document.getElementById('questionForm');
      
      const response = await fetch('/question.php', {
        method: 'POST',
        body: new FormData(formElem)
      });


      if (response.status === 401) {
        window.location.href = '/login.html';
      }else if (response.status === 100) {
        window.location.href = '/result.html';
      }
      
      const htmlPage = await response.text();
      document.getElementById('questionForm').outerHTML = htmlPage;
    });

    document.getElementById('questionForm').addEventListener('submit', async function(event) {
      event.preventDefault(); // Prevent form submission

      const response = await fetch('/question.php', {
        method: 'POST',
        body: new FormData(formElem)
      });

      if (response.status === 401) {
        window.location.href = '/login.html';
      }

      const htmlPage = await response.text();
      
      document.getElementById('questionForm').outerHTML = htmlPage;
    });
  </script>
</body>
</html>
